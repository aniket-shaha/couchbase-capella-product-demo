<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Capella Product Search</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-900 text-white min-h-screen flex flex-col items-center px-4 py-6 font-sans">
    <h1 class="text-3xl font-bold mb-6 text-center">üîç Capella Product Search</h1>

    <form id="searchForm" class="w-full max-w-md flex gap-2 mb-6">
      <input
        id="query"
        type="text"
        placeholder="Search products (e.g. mouse, laptop)..."
        class="flex-1 px-4 py-2 rounded-lg text-black focus:outline-none"
        required
      />
      <button
        type="submit"
        class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-semibold"
      >
        Search
      </button>
    </form>

    <div id="results" class="w-full max-w-4xl grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"></div>

    <script>
      const form = document.getElementById("searchForm");
      const resultsContainer = document.getElementById("results");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const query = document.getElementById("query").value.trim();
        if (!query) return;

        resultsContainer.innerHTML = `<p class="text-gray-400">Searching for "<strong>${query}</strong>"...</p>`;

        try {
          const res = await fetch("/search?q=" + encodeURIComponent(query));
          const data = await res.json();

          if (!data.length) {
            resultsContainer.innerHTML = `<p class="text-red-400">No products found.</p>`;
            return;
          }

          resultsContainer.innerHTML = data.map(item => `
            <div class="bg-white text-black p-4 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300">
              <h2 class="text-xl font-bold mb-2">${item.name}</h2>
              <p class="text-sm text-gray-700">Category: ${item.category}</p>
              <p class="text-sm">Price: ‚Çπ${item.price}</p>
              <p class="text-sm">Rating: ‚≠ê ${item.rating}</p>
              <p class="text-sm text-green-600">In Stock: ${item.stock}</p>
            </div>
          `).join("");
        } catch (err) {
          resultsContainer.innerHTML = `<p class="text-red-500">Error fetching results. Try again.</p>`;
          console.error(err);
        }
      });
    </script>
  </body>
</html>
